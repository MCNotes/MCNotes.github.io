<!DOCTYPE html>
<html>
<!--custom header -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title> MC notes</title>
  <meta name="description" content="Open Data Science built upon Jupyter Notebooks">


  <!-- Style sheets -->
  <!--Material bootstrap -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/css/mdb.min.css" rel="stylesheet" medial ="all">

  <!-- Font awesome -->
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" media="all">

  <!-- Boostrap-->
  <link rel="stylesheet" href="/css/main.css">


  <!-- URL -->
  <link rel="canonical" href="http://mcnotes.github.io/notebook.html">


  <!-- The various JS scripts used in the website -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://use.fontawesome.com/ff95ae1185.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
  integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
  crossorigin="anonymous"></script>


  <!-- add after bootstrap.min.js -->
  <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.4.1/dist/bootstrap-toc.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.3.0/js/mdb.min.js"></script>
  <script src="/js/custom-scripts.js"></script>

<!-- github js-->
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>

</head>


<!-- scroller for TOC-->
<body data-spy="scroll" data-target="#toc">


<!--Main content needs to be in a wrap for
  when the sidebar is displayed-->
  <div class='wrap'>

    <!-- navbar -->
    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation"
    id = 'top_nav'>
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse"
                data-target="#nav_collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href='http://mcnotes.github.io' class="navbar-brand" >MC notes</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="nav_collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="http://mcnotes.github.io/about/"> About </a>
                    </li>

                    <li>
                        <a href="http://mcnotes.github.io/notebook.html"> Volumes </a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>


    <!-- tools and headers -->
    <!-- Add tool bar  and headers to the top of the notebooks -->
<!-- Large header that shrinks -->
<div class="header nb">
  <h1 class="header_logo">Analysis of variance</h1> <br>
  <h4 class='author'> Author: T.Tania </h4>
</div>

<!-- Smaller header: menu and notebook info -->
<div class="menu" >
  <div class='container'>
    <div class='menu-title'> Analysis of variance </div>
    <div class='author'> Author: T.Tania</div>

    <!-- Tools in menu-->
    <div class="nav navbar-nav2 menu-right">
      <a href=""" | absolute_url }}""
      download="AoV_R_Notebook.ipynb" class="menu-icon" data-toggle="popover"
      data-content="Download notebook">
      <i class="fa fa-download" aria-hidden="true"></i></a>

      <a class='menu-icon' data-toggle="popover"  data-content="Dyslexia friendly"
      onclick='dyslexia_friendly()'>
      <i class="fa fa-eye" aria-hidden="true"></i> </a>

      <a class='menu-icon' data-toggle="popover"  data-content="Launch in Azure"
      href='https://notebooks.azure.com'>
      <i class="fa fa-cloud" aria-hidden="true"></i> </a>
    </ul>
  </div>
</div>
</div>


"" | absolute_url }}"

  </div>

  <!-- Main content -->
  <div class='wrap'>
    <div class="container offset_nb">
      <div class="row">

        <!--- Notebook content content--->
        <div class="col-sm-9 col-lg-9 ">
          <main>
            <h1 id="bad-day-2-anova">BAD DAY 2: ANOVA</h1>

<h1 id="1-analysis-of-variance-anova-models">1. Analysis of variance: ANOVA models</h1>

<p><br /></p>
<font color="#00bcd4"> In [1]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Setting the right working dir
</span><span class="w">
</span><span class="n">bad2dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getwd</span><span class="p">()</span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="n">bad2dir</span><span class="p">)</span></code></pre></figure>

<p>Loading the data: in this case we ae going to work with the <code class="highlighter-rouge">growth1</code> data set
provided as art of this course. The data is contained within a <code class="highlighter-rouge">.csv</code> file.</p>

<p><br /></p>
<font color="#00bcd4"> In [2]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># data=read.delim('./Data/growth.txt',header=TRUE)
</span><span class="n">data1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s1">'./Data/growth1.csv'</span><span class="p">)</span></code></pre></figure>

<p>Letâ€™s first have a look at the dimension  of the data</p>

<p><br /></p>
<font color="#00bcd4"> In [3]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">dim</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span></code></pre></figure>

<ol class="list-inline">
	<li>31</li>
	<li>2</li>
</ol>

<p>Printing the column names:</p>

<p><br /></p>
<font color="#00bcd4"> In [4]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">colnames</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span></code></pre></figure>

<ol class="list-inline">
	<li>'Growth'</li>
	<li>'Treatment'</li>
</ol>

<p>Getting a basic statistical summary on the data:</p>

<p><br /></p>
<font color="#00bcd4"> In [5]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">summary</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>     Growth        Treatment
 Min.   : 5.00   A      :7  
 1st Qu.:14.00   B      :5  
 Median :36.00   C      :5  
 Mean   :38.68   Control:4  
 3rd Qu.:61.50   D      :5  
 Max.   :83.00   E      :5  
</code></pre>
</div>

<p><br /></p>
<font color="#00bcd4"> In [6]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># making the objects in the dataframe accessible
</span><span class="n">attach</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span></code></pre></figure>

<p><br /></p>
<font color="#00bcd4"> In [7]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Treatment</span></code></pre></figure>

<ol class="list-inline">
	<li>C</li>
	<li>C</li>
	<li>C</li>
	<li>C</li>
	<li>C</li>
	<li>E</li>
	<li>E</li>
	<li>E</li>
	<li>E</li>
	<li>E</li>
	<li>D</li>
	<li>D</li>
	<li>D</li>
	<li>D</li>
	<li>D</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>B</li>
	<li>B</li>
	<li>B</li>
	<li>B</li>
	<li>B</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
</ol>

<p>In this case we have a column for the <em>DEPENDENT</em> variable (Growth) and a column
for the  <em>FACTOR</em> (Treatment).</p>

<p>The first column contains numeric data but the second contains letters. It does
not matter to R which form you have your dependent factors (letters or numbers)
but it will be easier to interpret the results if you use meaningful names.</p>

<h3 id="ready-to-run-the-analysis">Ready to run the analysis.</h3>

<p><br /></p>
<font color="#00bcd4"> In [8]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">data.aov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aov</span><span class="p">(</span><span class="n">Growth</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Treatment</span><span class="p">)</span></code></pre></figure>

<p>Notice here the symbol (a tilde) in the model. This means take Growth as the
DEPENDENT variable, indeed it depends on the Treatment.</p>

<p>We can then print the results of the analysis of variance</p>

<p><br /></p>
<font color="#00bcd4"> In [9]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#see the results: not very clear
</span><span class="n">data.aov</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>Call:
   aov(formula = Growth ~ Treatment)

Terms:
                Treatment Residuals
Sum of Squares  19459.167   973.607
Deg. of Freedom         5        25

Residual standard error: 6.240536
Estimated effects may be unbalanced
</code></pre>
</div>

<p>In order to get more information we need to view the analysis summary:</p>

<p><br /></p>
<font color="#00bcd4"> In [10]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">summary</span><span class="p">(</span><span class="n">data.aov</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Treatment    5  19459    3892   99.93 1.07e-15 ***
Residuals   25    974      39                     
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
</code></pre>
</div>

<h1 id="2-post-hoc-testing">2. Post-hoc testing</h1>

<p>This was an example of a simple one-way anova. According to the summary we see
that there is a significant effect of Treatment upon Growth. However, there are
5 treatments!</p>

<p>It is crucial to know which of these treatments are significantly different from
the each other (e.g. control treatments). R provides a simple function to carry
out the Tukey HSD test.</p>

<p><br /></p>
<font color="#00bcd4"> In [11]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">TukeyHSD</span><span class="p">(</span><span class="n">data.aov</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><pre class="highlight"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Growth ~ Treatment)

$Treatment
               diff        lwr        upr     p adj
B-A       -12.65714 -23.918244  -1.396042 0.0211539
C-A        47.54286  36.281756  58.803958 0.0000000
Control-A -18.10714 -30.161431  -6.052855 0.0012274
D-A        32.94286  21.681756  44.203958 0.0000000
E-A        38.54286  27.281756  49.803958 0.0000000
C-B        60.20000  48.036621  72.363379 0.0000000
Control-B  -5.45000 -18.351212   7.451212 0.7812490
D-B        45.60000  33.436621  57.763379 0.0000000
E-B        51.20000  39.036621  63.363379 0.0000000
Control-C -65.65000 -78.551212 -52.748788 0.0000000
D-C       -14.60000 -26.763379  -2.436621 0.0121584
E-C        -9.00000 -21.163379   3.163379 0.2390481
D-Control  51.05000  38.148788  63.951212 0.0000000
E-Control  56.65000  43.748788  69.551212 0.0000000
E-D         5.60000  -6.563379  17.763379 0.7157067
</code></pre>
</div>

<h1 id="3-two-way-anova">3. Two way ANOVA</h1>

<p>Loading the data to be used</p>

<p><br /></p>
<font color="#00bcd4"> In [12]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">data2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s1">'./Data/growth2.csv'</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span></code></pre></figure>

<ol class="list-inline">
	<li>'Growth'</li>
	<li>'Treatment'</li>
	<li>'Gender'</li>
</ol>

<p><br /></p>
<font color="#00bcd4"> In [13]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">detach</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span><span class="w">  </span><span class="c1"># detach the previoulsy attached data set
</span><span class="n">attach</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">making</span><span class="w"> </span><span class="n">data2</span><span class="w"> </span><span class="n">accessible</span></code></pre></figure>

<p><br /></p>
<font color="#00bcd4"> In [14]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Gender</span></code></pre></figure>

<ol class="list-inline">
	<li>M</li>
	<li>M</li>
	<li>M</li>
	<li>F</li>
	<li>F</li>
	<li>F</li>
	<li>F</li>
	<li>M</li>
	<li>M</li>
	<li>M</li>
	<li>F</li>
	<li>F</li>
	<li>F</li>
	<li>M</li>
	<li>M</li>
	<li>M</li>
	<li>F</li>
	<li>F</li>
	<li>M</li>
	<li>M</li>
	<li>M</li>
	<li>F</li>
	<li>F</li>
	<li>F</li>
	<li>M</li>
	<li>M</li>
	<li>M</li>
	<li>F</li>
	<li>F</li>
	<li>M</li>
	<li>M</li>
	<li>F</li>
	<li>F</li>
	<li>M</li>
	<li>M</li>
</ol>

<p><br /></p>
<font color="#00bcd4"> In [15]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Treatment</span></code></pre></figure>

<ol class="list-inline">
	<li>C</li>
	<li>C</li>
	<li>C</li>
	<li>C</li>
	<li>C</li>
	<li>E</li>
	<li>E</li>
	<li>E</li>
	<li>E</li>
	<li>E</li>
	<li>D</li>
	<li>D</li>
	<li>D</li>
	<li>D</li>
	<li>D</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>A</li>
	<li>B</li>
	<li>B</li>
	<li>B</li>
	<li>B</li>
	<li>B</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
	<li>Control</li>
</ol>

<p><br /></p>
<font color="#00bcd4"> In [16]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">length</span><span class="p">(</span><span class="n">Gender</span><span class="p">)</span></code></pre></figure>

<p>35</p>

<p>We can compare the two times or the two shoes by looking at summary statistics
or at parallel boxplots. To get the means for each level of each factor, use Râ€™s
tapply command.</p>

<p>This takes three arguments: the data you wish to summarize, the factor that
determines the groups, and the function you wish to apply to each of the groups.</p>

<p>First we will compute the mean Growth as a function of the Treatment type:</p>

<p><br /></p>
<font color="#00bcd4"> In [17]: </font>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">tapply</span><span class="p">(</span><span class="n">Growth</span><span class="p">,</span><span class="w"> </span><span class="n">Treatment</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span></code></pre></figure>

<dl class="dl-horizontal">
	<dt>A</dt>
		<dd>23.8571428571429</dd>
	<dt>B</dt>
		<dd>11.2</dd>
	<dt>C</dt>
		<dd>71.4</dd>
	<dt>Control</dt>
		<dd>6</dd>
	<dt>D</dt>
		<dd>56.8</dd>
	<dt>E</dt>
		<dd>62.4</dd>
</dl>

<p><br /></p>
<font color="#00bcd4"> In [18]: </font>

          </main>
        </div>

        <!--- Side bar with TOC and comments--->
        <div class="col-sm-3 well2">
          
<!-- Side bar with additional features -->

  <!-- extra tabs -->
  <div  class="container verticalLine" >
    <ul class="nav nav-tabs">
      <li class="active">
        <a  href="#toc-tab" data-toggle="tab">Content</a>
      </li>
      <li><a href="#rec-tab" data-toggle="tab">References</a>
      </li>
      <li><a href="#com-tab" data-toggle="tab">Reviewers' comments</a>
      </li>
    </ul>

    <!--tabs content -->
    <div class="tab-content ">
      <div class="tab-pane active" id="toc-tab">
        <nav id="toc"  data-toggle="toc"> </nav>
      </div>
      <div class="tab-pane" id="rec-tab">
        References here :)
      </div>
      <div class="tab-pane" id="com-tab">
        Comments
      </div>

    </div>
  </div>

        </div>
      </div>
    </div>
  </div>

<!-- Footer -->

<!--Footer-->
<footer class="page-footer center-on-small-only">
<div id="gotop"><i class="fa fa-chevron-up" aria-hidden="true"></i></div>
  <!--Copyright-->
    <div class="footer-copyright">
        <div class="container-fluid">
            Â© 2017 Copyright: <a href="http://rse.shef.ac.uk"> RSE at Sheffield</a>

        </div>
    </div>
    <!--/.Copyright-->

</footer>
<!--/.Footer-->


  </body>


  </html>
